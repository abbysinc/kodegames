<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Kode games.exe</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Courier New', monospace;
}

body{
  width:100vw;
  height:100vh;
  background:black;
  overflow:hidden;
  image-rendering: pixelated;
}

.screen{
  position:absolute;
  width:100%;
  height:100%;
  display:none;
  justify-content:center;
  align-items:center;
}

.active{ display:flex; }

/* LOGIN */
#login{
  background:url("pollo/fondos/fondo_login.png") center/cover no-repeat;
  flex-direction:column;
}

.login-box{
  background:rgba(0,0,0,0.85);
  border:3px solid red;
  padding:20px;
  width:300px;
}

#error{ color:red; text-align:center; display:none; }

/* MAIN / MANSIÃ“N */
#main{
  background:url("pollo/fondos/fondo1.png") center/cover no-repeat;
  padding:20px;
}

#character{
  width:256px;
  height:256px;
  background:url("pollo/personaje/idle.png") center/contain no-repeat;
}

.panel{
  margin-left:20px;
  color:white;
}

.panel button{
  margin-top:10px;
  padding:10px;
  width:220px;
  background:#222;
  color:white;
  border:2px solid white;
  cursor:pointer;
}

.panel button.on{ background:green; }

textarea{
  margin-top:10px;
  width:300px;
  height:80px;
  background:black;
  color:#00ff00;
  border:2px solid #00ff00;
}

/* BOTÃ“N CIRCULAR LOGIN */
#loginOrb{
  position:absolute;
  top:20px;
  right:20px;
  width:60px;
  height:60px;
  border-radius:50%;
  background:#00ff00;
  color:black;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  border:3px solid black;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login" class="screen">
  <div class="login-box">
    <h2 style="color:red">LOGIN</h2>
    <input id="user" placeholder="USUARIO">
    <input id="pass" type="password" placeholder="CONTRASEÃ‘A">
    <button id="loginBtn">ENTRAR</button>
    <div id="error">NO AUTORIZADO</div>
  </div>
</div>

<!-- MAIN / MANSIÃ“N -->
<div id="main" class="screen active">
  <div id="loginOrb">ðŸ”’</div>

  <div id="character"></div>

  <div class="panel">
    <button id="powerBtn">ENCENDER PERSONAJE</button>
    <textarea id="textInput" placeholder="EscribÃ­ el mensaje..."></textarea>
    <button id="sendBtn">TEXTO</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyBP-twUwMdVbG-SKWsWCxzssROI64bzkdI",
  authDomain: "kodegames-6df40.firebaseapp.com",
  databaseURL: "https://kodegames-6df40-default-rtdb.firebaseio.com",
  projectId: "kodegames-6df40",
  storageBucket: "kodegames-6df40.firebasestorage.app",
  messagingSenderId: "394434413800",
  appId: "1:394434413800:web:053531e404f1396f09b55d"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const estadoRef = ref(db, "estado");

/* DOM */
const main = document.getElementById("main");
const login = document.getElementById("login");
const loginOrb = document.getElementById("loginOrb");

const powerBtn = document.getElementById("powerBtn");
const character = document.getElementById("character");
const textInput = document.getElementById("textInput");
const sendBtn = document.getElementById("sendBtn");

/* BOTÃ“N CIRCULAR â†’ LOGIN */
loginOrb.onclick = () => {
  main.classList.remove("active");
  login.classList.add("active");
};

/* LOGIN SIMPLE */
loginBtn.onclick = () => {
  login.classList.remove("active");
  main.classList.add("active");
};

/* FIREBASE */
onValue(estadoRef, snap=>{
  const d = snap.val();
  if(!d) return;

  if(d.encendido){
    powerBtn.classList.add("on");
    powerBtn.textContent="PERSONAJE ACTIVO";
    character.style.backgroundImage='url("pollo/personaje/encender_1.gif")';
  }else{
    powerBtn.classList.remove("on");
    powerBtn.textContent="ENCENDER PERSONAJE";
    character.style.backgroundImage='url("pollo/personaje/idle.png")';
  }
});

/* ACCIONES */
powerBtn.onclick = ()=>{
  set(estadoRef,{ encendido:true });
};

sendBtn.onclick = ()=>{
  set(estadoRef,{ encendido:true, texto:textInput.value });
};
</script>

</body>
</html>
