<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Kode games.exe</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Courier New', monospace;
}

body{
  width:100vw;
  height:100vh;
  background:black;
  overflow:hidden;
  image-rendering: pixelated;
}

.screen{
  position:absolute;
  width:100%;
  height:100%;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

.active{ display:flex; }

#home{
  background:url("pollo/fondos/fondo1.png") center/cover no-repeat;
}

#btnJ{
  font-size:80px;
  padding:30px 70px;
  background:black;
  color:#00ff00;
  border:4px solid #00ff00;
  cursor:pointer;
}

#login{
  background:url("pollo/fondos/fondo_login.png") center/cover no-repeat;
}

.login-box{
  background:rgba(0,0,0,0.85);
  border:3px solid red;
  padding:20px;
  width:300px;
  animation: glitch 1.5s infinite;
}

@keyframes glitch{
  0%{ transform:translate(0); }
  20%{ transform:translate(-2px,2px); }
  40%{ transform:translate(2px,-2px); }
  60%{ transform:translate(-1px,1px); }
  80%{ transform:translate(1px,-1px); }
  100%{ transform:translate(0); }
}

.login-box h2{ color:red; text-align:center; margin-bottom:15px; }

.login-box input{
  width:100%;
  padding:8px;
  margin-bottom:10px;
  background:black;
  color:#00ff00;
  border:1px solid #00ff00;
}

.login-box button{
  width:100%;
  padding:10px;
  background:red;
  color:white;
  border:none;
  cursor:pointer;
}

#error{ color:red; text-align:center; display:none; }

#main{
  background:url("pollo/fondos/fondo1.png") center/cover no-repeat;
  flex-direction:row;
  padding:20px;
}

#character{
  width:256px;
  height:256px;
  background:url("pollo/personaje/idle.png") center/contain no-repeat;
}

.panel{ margin-left:20px; color:white; }

.panel button{
  margin-top:10px;
  padding:10px;
  width:220px;
  background:#222;
  color:white;
  border:2px solid white;
  cursor:pointer;
}

.panel button.on{ background:green; }

textarea{
  margin-top:10px;
  width:300px;
  height:80px;
  background:black;
  color:#00ff00;
  border:2px solid #00ff00;
}

#dialog{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.9);
  border:3px solid white;
  padding:10px;
  width:80%;
  color:white;
  font-size:18px;
  min-height:60px;
}
</style>
</head>

<body>

<div id="home" class="screen active">
  <button id="btnJ">J</button>
</div>

<div id="login" class="screen">
  <div class="login-box">
    <h2>ACCESO RESTRINGIDO</h2>
    <input id="user" placeholder="USUARIO">
    <input id="pass" type="password" placeholder="CONTRASEÃ‘A">
    <button onclick="loginUser()">ENTRAR</button>
    <div id="error">USUARIO NO AUTORIZADO</div>
  </div>
</div>

<div id="main" class="screen">
  <div id="character"></div>

  <div class="panel">
    <button id="powerBtn">ENCENDER PERSONAJE</button>
    <textarea id="textInput" placeholder="EscribÃ­ el mensaje..."></textarea>
    <button onclick="sendText()">TEXTO</button>
  </div>

  <div id="dialog"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

/* ðŸ” TU FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyBP-twUwMdVbG-SKWsWCxzssROI64bzkdI",
  authDomain: "kodegames-6df40.firebaseapp.com",
  databaseURL: "https://kodegames-6df40-default-rtdb.firebaseio.com",
  projectId: "kodegames-6df40",
  storageBucket: "kodegames-6df40.firebasestorage.app",
  messagingSenderId: "394434413800",
  appId: "1:394434413800:web:053531e404f1396f09b55d",
  measurementId: "G-J8R3GT190D"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const estadoRef = ref(db, "estado");

/* NAVEGACIÃ“N */
const home = document.getElementById("home");
const login = document.getElementById("login");
const main = document.getElementById("main");
btnJ.onclick = ()=>{
  home.classList.remove("active");
  login.classList.add("active");
};

/* LOGIN LOCAL */
const USERS = { admin:"404", jota:"pollo", beta:"game", dark:"pixel" };
window.loginUser = ()=>{
  const u = user.value, p = pass.value;
  if(USERS[u] === p){
    login.classList.remove("active");
    main.classList.add("active");
    error.style.display="none";
  }else error.style.display="block";
};

/* TIEMPO REAL */
onValue(estadoRef, snap=>{
  const d = snap.val();
  if(!d) return;

  if(d.encendido){
    powerBtn.classList.add("on");
    powerBtn.textContent="PERSONAJE ACTIVO";
    character.style.backgroundImage='url("pollo/personaje/encender_1.gif")';
    main.style.backgroundImage='url("pollo/fondos/fondo_activado.png")';
  }else{
    powerBtn.classList.remove("on");
    powerBtn.textContent="ENCENDER PERSONAJE";
    character.style.backgroundImage='url("pollo/personaje/idle.png")';
  }

  dialog.textContent = d.texto || "";
};

/* ACCIONES */
powerBtn.onclick = ()=>{
  set(estadoRef,{ encendido:true, texto:"" });
};

window.sendText = ()=>{
  set(estadoRef,{ encendido:true, texto:textInput.value });
};
</script>

</body>
</html>
